#!/usr/bin/perl6

use v6;

token total		{ \! }
token many		{ \* }
token end			{ \; }

rule desc {
	'<' <ident> '>'
}

rule attrs {
	attr <attr>*
}

rule attr {
	<ident>
}

rule entity {
	'weak'? entity <ident> <attrs>? <end>
}

rule relate {
	'weak'? relate <ident> <relate_to>* <attrs>? <end>
}

rule relate_to {
	<ident> <desc>? <total>? <many>?
}

rule file {
	[<entity> | <relate>]*
}

my $file = file($*IN.slurp).result_object;

say $file<entity>.perl;

